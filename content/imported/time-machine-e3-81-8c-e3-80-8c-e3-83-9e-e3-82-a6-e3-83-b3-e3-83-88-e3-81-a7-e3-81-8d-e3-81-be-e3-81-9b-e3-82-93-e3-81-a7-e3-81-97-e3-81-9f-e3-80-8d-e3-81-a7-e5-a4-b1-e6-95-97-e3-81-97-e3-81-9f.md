Title: Time Machineが「マウントできませんでした」で失敗したときに試してみること
Date: 2011-05-22 05:20
Author: masayukig
Tags: Apple, Mac, timemachine
Status: published

現在、Time MachineをNAS上のボリュームで使っているのですが、たまに、
「マウントできませんでした」
という感じのエラーが発生し、バックアップができなくなることがあります。
そのとき、/var/log/system.logには以下の様な出力がありました。

    May 22 04:20:49 ariel com.apple.backupd[6949]: Error 45 creating backup disk image
    May 22 04:20:49 ariel com.apple.backupd[6949]: Failed to create disk image /Volumes/Public/ariel.sparsebundle, status: 45
    May 22 04:20:54 ariel com.apple.backupd[6949]: Backup failed with error: 20
    May 22 04:20:55 ariel com.apple.backupd[6949]: Ejected Time Machine network volume.

こういう場合には、以下を試してみます。
**
[なお、これらの作業は自己責任でお願いします。]{style="color:#ff0000;"}
[私の環境ではうまく行きましたが、すべての環境でうまく行くとは限りません。]{style="color:#ff0000;"}
**

1.  Time
    Machineバックアップに失敗すると、ディレクトリ名に日付／時間がついてしまうので、それを元に戻す。

        $ mv ariel_XXXXXXXXXXXX_2011-05-21-113228.sparsebundle ariel_XXXXXXXXXXXX.sparsebundle

2.  変更禁止フラグがたっている(らしい)ので、それを解除。

        $ chflags nouchg ariel_XXXXXXXXXXXX.sparsebundle

3.  以下のファイル内容の修正を行う。

        $ vim ariel_XXXXXXXXXXXX.sparsebundle/com.apple.TimeMachine.MachineID.plist

                VerificationState
          2

    を

                VerificationState
          1

    に変更。

4.  変更禁止フラグを再度設定。

        $ chflags uchg ariel_XXXXXXXXXXXX.sparsebundle

5.  再度、バックアップを試してみる。

＃まぁ、本当に大丈夫なのかどうかは、リストアしてみるまでわかりませんが。。w

参考サイト: [mtaneda’s diary](http://d.hatena.ne.jp/mtaneda/) -
[続・Time Machine
によるバックアップの検証が完了しました。信頼性を向上するために、新規バックアップの作成が必要になりました。](http://d.hatena.ne.jp/mtaneda/20101207/1291670192)
